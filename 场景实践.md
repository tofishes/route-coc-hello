## 场景实践

2. **API地址预处理。**
  例如，有接口地址为 http://domain/comment/list, http://domain/product/list等。 在router配置里可以设置为：
  ```
  {
    '/page/comments': {
      'get': {
         'api': '/comment/list',
         ...
      }
    },
    '/page/product': {
      'get': {
        'api': '/comment/list',
        ...
      }
    }
  }
  ```
  coc调用时设置handleAPI参数为：
  ```
  coc(app, {
    handleAPI(url) {
      return 'http://domain' + url;
    }
  })
  ```
3. **验证码图片转发、外部接口代理**
4. **接口数据统计**
5. **loadModule，方便的代码管理方式**
  ```
  function loadModule(dir, callback) {
    const files = glob.sync(`${dir}/**/*.js`);
    files.forEach(file => {
      const mod = require(file); // eslint-disable-line global-require
      callback(mod);
    });
  }
  ```
  用以上方法载入指定目录下的js模块。比如 stage filters定义到一个目录中，用上述方法自动载入。
  ```
  // use coc
  const cocer = coc(app);

  loadModule(`${__dirname}/libs/stage-filters`, mod => {
    mod(cocer);
  });
  ```
6. **接口数据缓存**
  若某个api返回相对固定的数据结构，例如分类信息，省市区信息，可以设置router.cache|router.api.cache为true，这样可以将这些数据第一次请求之后缓存起来，不用每次都请求接口。
  coc options可以设置缓存方法apiDataCache，默认缓存到内存中。
  
7. ** 接入到已有项目中 **
  假如已有一个线上项目的express实现，想部分功能使用coc，可以利用coc options.mount指定某些功能路径使用coc。
  例如：
  ```
  // coc可以执行多次
  const productStage = coc(app, {
    'mount': '/product'  // 产品模块使用coc
  });
  const newsStage = coc(app, {
    'mount': '/news'  // 新闻模块使用coc
  });
  ```